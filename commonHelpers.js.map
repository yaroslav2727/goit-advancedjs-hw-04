{"version":3,"file":"commonHelpers.js","sources":["../src/getImages.js","../src/index.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getImages(query, pageNumber, resultsAmount) {\n  const BASE_URL = \"https://pixabay.com/api/\";\n  const API_KEY = \"40892819-7576baf715197fa05f261aab0\";\n\n  const resp = await axios.get(`${BASE_URL}`, {\n    params: {\n      key: `${API_KEY}`,\n      q: `${query}`,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: \"true\",\n      page: `${pageNumber}`,\n      per_page: `${resultsAmount}`,\n    },\n  });\n  return resp.data;\n}\n","import \"modern-normalize/modern-normalize.css\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getImages } from \"./getImages\";\nimport SimpleLightbox from \"simplelightbox\";\nimport iziToast from \"izitoast\";\n\niziToast.settings({\n  position: \"bottomCenter\",\n  timeout: 2500,\n});\n\nconst RESULTS_PER_PAGE = 40;\n\nconst formEl = document.querySelector(\".search-form\");\nconst galleryEl = document.querySelector(\".gallery\");\nconst observerEl = document.querySelector(\".js-observer\");\n\nconst lightbox = new SimpleLightbox(\".gallery a\");\nconst observer = new IntersectionObserver(observerAction, {\n  rootMargin: \"1000px\",\n});\n\nformEl.addEventListener(\"submit\", onSubmit);\n\nlet currentPage;\nlet currentQuery;\n\nfunction onSubmit(event) {\n  event.preventDefault();\n  const query = event.currentTarget.elements.searchQuery.value.trim().replace(/\\s+/g, \"+\");\n  if (!query) {\n    iziToast.info({ message: \"Please enter your search query.\" });\n    return;\n  }\n  if (query === currentQuery) {\n    iziToast.info({ message: \"For a new search, please enter another search query.\" });\n    return;\n  }\n  currentPage = 0;\n  currentQuery = query;\n  galleryEl.innerHTML = \"\";\n  observer.observe(observerEl);\n}\n\nasync function observerAction(entries) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      currentPage += 1;\n      const newMarkup = await drawMarkup(currentQuery, currentPage);\n      if (newMarkup) {\n        galleryEl.insertAdjacentHTML(\"beforeend\", newMarkup);\n        lightbox.refresh();\n      }\n    }\n  });\n}\n\nasync function drawMarkup(query, pageNumber = 1) {\n  try {\n    const data = await getImages(query, pageNumber, RESULTS_PER_PAGE);\n    if (!data.totalHits) {\n      iziToast.error({\n        message: \"Sorry, there are no images matching your search query. Please try again.\",\n        timeout: 5000,\n      });\n      observer.disconnect();\n      return \"\";\n    }\n    if (pageNumber === 1) {\n      iziToast.success({ message: `Hooray! We found ${data.totalHits} images.` });\n    }\n    if (data.totalHits <= pageNumber * RESULTS_PER_PAGE) {\n      iziToast.info({ message: \"All found images are displayed.\" });\n      observer.disconnect();\n    }\n    return data.hits\n      .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `\n                <a\n                    class=\"photo-card\"\n                    href=\"${largeImageURL}\"\n    \n                >\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"300\" height=\"200\" />\n                    <div class=\"info\">\n                        <p class=\"info-item\">\n                            <b>Likes</b> ${likes}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Views</b> ${views}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Comments</b> ${comments}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Downloads</b> ${downloads}\n                        </p>\n                    </div>\n                </a>`;\n      })\n      .join(\"\");\n  } catch (err) {\n    console.dir(err);\n    iziToast.error({ message: err.message });\n    observer.disconnect();\n  }\n}\n"],"names":["getImages","query","pageNumber","resultsAmount","BASE_URL","API_KEY","axios","iziToast","RESULTS_PER_PAGE","formEl","galleryEl","observerEl","lightbox","SimpleLightbox","observer","observerAction","onSubmit","currentPage","currentQuery","event","entries","entry","newMarkup","drawMarkup","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","err"],"mappings":"owBAEO,eAAeA,EAAUC,EAAOC,EAAYC,EAAe,CAChE,MAAMC,EAAW,2BACXC,EAAU,qCAahB,OAXa,MAAMC,EAAM,IAAI,GAAGF,IAAY,CAC1C,OAAQ,CACN,IAAK,GAAGC,IACR,EAAG,GAAGJ,IACN,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAM,GAAGC,IACT,SAAU,GAAGC,GACd,CACL,CAAG,GACW,IACd,CCXAI,EAAS,SAAS,CAChB,SAAU,eACV,QAAS,IACX,CAAC,EAED,MAAMC,EAAmB,GAEnBC,EAAS,SAAS,cAAc,cAAc,EAC9CC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAa,SAAS,cAAc,cAAc,EAElDC,EAAW,IAAIC,EAAe,YAAY,EAC1CC,EAAW,IAAI,qBAAqBC,EAAgB,CACxD,WAAY,QACd,CAAC,EAEDN,EAAO,iBAAiB,SAAUO,CAAQ,EAE1C,IAAIC,EACAC,EAEJ,SAASF,EAASG,EAAO,CACvBA,EAAM,eAAc,EACpB,MAAMlB,EAAQkB,EAAM,cAAc,SAAS,YAAY,MAAM,OAAO,QAAQ,OAAQ,GAAG,EACvF,GAAI,CAAClB,EAAO,CACVM,EAAS,KAAK,CAAE,QAAS,iCAAmC,CAAA,EAC5D,MACD,CACD,GAAIN,IAAUiB,EAAc,CAC1BX,EAAS,KAAK,CAAE,QAAS,sDAAwD,CAAA,EACjF,MACD,CACDU,EAAc,EACdC,EAAejB,EACfS,EAAU,UAAY,GACtBI,EAAS,QAAQH,CAAU,CAC7B,CAEA,eAAeI,EAAeK,EAAS,CACrCA,EAAQ,QAAQ,MAAMC,GAAS,CAC7B,GAAIA,EAAM,eAAgB,CACxBJ,GAAe,EACf,MAAMK,EAAY,MAAMC,EAAWL,EAAcD,CAAW,EACxDK,IACFZ,EAAU,mBAAmB,YAAaY,CAAS,EACnDV,EAAS,QAAO,EAEnB,CACL,CAAG,CACH,CAEA,eAAeW,EAAWtB,EAAOC,EAAa,EAAG,CAC/C,GAAI,CACF,MAAMsB,EAAO,MAAMxB,EAAUC,EAAOC,EAAYM,CAAgB,EAChE,OAAKgB,EAAK,WAQNtB,IAAe,GACjBK,EAAS,QAAQ,CAAE,QAAS,oBAAoBiB,EAAK,mBAAmB,CAAE,EAExEA,EAAK,WAAatB,EAAaM,IACjCD,EAAS,KAAK,CAAE,QAAS,iCAAmC,CAAA,EAC5DO,EAAS,WAAU,GAEdU,EAAK,KACT,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,KAC1D;AAAA;AAAA;AAAA,4BAGaL;AAAA;AAAA;AAAA,gCAGID,WAAsBE;AAAA;AAAA;AAAA,2CAGXC;AAAA;AAAA;AAAA,2CAGAC;AAAA;AAAA;AAAA,8CAGGC;AAAA;AAAA;AAAA,+CAGCC;AAAA;AAAA;AAAA,qBAIxC,EACA,KAAK,EAAE,IAvCRxB,EAAS,MAAM,CACb,QAAS,2EACT,QAAS,GACjB,CAAO,EACDO,EAAS,WAAU,EACZ,GAmCV,OAAQkB,EAAP,CACA,QAAQ,IAAIA,CAAG,EACfzB,EAAS,MAAM,CAAE,QAASyB,EAAI,OAAS,CAAA,EACvClB,EAAS,WAAU,CACpB,CACH"}